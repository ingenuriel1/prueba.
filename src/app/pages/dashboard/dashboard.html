<div class="dashboard-container">
  <div class="header">
    <h1>Gestión de Personas</h1>
    <button class="btn btn-primary" (click)="openForm()">+ Nueva Persona</button>
  </div>

  <!-- Modal Formulario -->
  @if (showForm) {
    <div class="modal-overlay" (click)="closeForm()">
      <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>{{ editingId ? 'Editar' : 'Nueva' }} Persona</h2>
          <button class="btn-close" (click)="closeForm()">&times;</button>
        </div>
        <form #form="ngForm" (ngSubmit)="savePersona()">
          <div class="form-group">
            <label for="nombre">Nombre *</label>
            <input type="text" id="nombre" [(ngModel)]="personaForm.nombre" name="nombre"
                   #nombre="ngModel" required [class.invalid]="nombre.invalid && nombre.touched">
            @if (nombre.invalid && nombre.touched) {
              <span class="error-message">El nombre es obligatorio</span>
            }
          </div>
          <div class="form-group">
            <label for="apellido">Apellido *</label>
            <input type="text" id="apellido" [(ngModel)]="personaForm.apellido" name="apellido"
                   #apellido="ngModel" required [class.invalid]="apellido.invalid && apellido.touched">
            @if (apellido.invalid && apellido.touched) {
              <span class="error-message">El apellido es obligatorio</span>
            }
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" [(ngModel)]="personaForm.email" name="email"
                   #email="ngModel" [class.invalid]="email.invalid && email.touched">
            @if (email.invalid && email.touched) {
              <span class="error-message">Ingrese un email válido</span>
            }
          </div>
          <div class="form-group">
            <label for="telefono">Teléfono</label>
            <input type="tel" id="telefono" [(ngModel)]="personaForm.telefono" name="telefono">
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-secondary" (click)="closeForm()">Cancelar</button>
            <button type="submit" class="btn btn-primary" [disabled]="form.invalid">{{ editingId ? 'Actualizar' : 'Guardar' }}</button>
          </div>
        </form>
      </div>
    </div>
  }

  <!-- Tabla de Personas -->
  <div class="table-container">
    @if (personas.length === 0) {
      <div class="empty-state">
        <p>No hay personas registradas</p>
      </div>
    } @else {
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Apellido</th>
            <th>Email</th>
            <th>Teléfono</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (persona of personas; track persona.id) {
            <tr>
              <td>{{ persona.id }}</td>
              <td>{{ persona.nombre }}</td>
              <td>{{ persona.apellido }}</td>
              <td>{{ persona.email }}</td>
              <td>{{ persona.telefono }}</td>
              <td class="actions">
                <button class="btn btn-edit" (click)="editPersona(persona)">Editar</button>
                <button class="btn btn-delete" (click)="deletePersona(persona.id)">Eliminar</button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>
</div>
